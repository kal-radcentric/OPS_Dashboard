<Window x:Class="OPS_Dashboard.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Salesforce Marketing Cloud ETL Dashboard"
        Height="750" Width="1200"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Step 1: FTP Download Section -->
        <GroupBox Grid.Row="0" Header="Step 1: Download Files via SFTP" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
                    <Button Name="btnDownloadFiles"
                            Content="Start Download"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            IsEnabled="{Binding IsDownloadEnabled}"
                            Command="{Binding DownloadFilesCommand}"/>

                    <Button Name="btnPauseDownload"
                            Content="{Binding DownloadPauseButtonText}"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            Margin="10,0,0,0"
                            IsEnabled="{Binding IsDownloading}"
                            Command="{Binding PauseDownloadCommand}"/>

                    <Button Name="btnCancelDownload"
                            Content="Cancel Download"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            Margin="10,0,0,0"
                            IsEnabled="{Binding IsDownloading}"
                            Command="{Binding CancelDownloadCommand}"/>

                    <TextBlock Text="Status:"
                               VerticalAlignment="Center"
                               Margin="20,0,5,0"/>
                    <TextBlock Text="{Binding DownloadStatus}"
                               VerticalAlignment="Center"
                               FontWeight="Bold"/>
                </StackPanel>

                <ProgressBar Grid.Row="1"
                            Height="25"
                            Value="{Binding DownloadProgress}"
                            Maximum="100"
                            Margin="0,0,0,10"/>

                <TextBlock Grid.Row="2"
                          Text="{Binding CurrentDownloadFile}"
                          Margin="0,0,0,5"/>
            </Grid>
        </GroupBox>

        <!-- FTP Download Log -->
        <GroupBox Grid.Row="1" Header="Download Log" Margin="0,0,0,10">
            <ScrollViewer Name="scrollDownloadLog" VerticalScrollBarVisibility="Auto">
                <TextBox Name="txtDownloadLog"
                        Text="{Binding DownloadLog}"
                        IsReadOnly="True"
                        TextWrapping="Wrap"
                        FontFamily="Consolas"
                        Background="#F5F5F5"
                        TextChanged="txtDownloadLog_TextChanged"/>
            </ScrollViewer>
        </GroupBox>

        <!-- Step 2: Process Files Section -->
        <GroupBox Grid.Row="2" Header="Step 2: Process CSV Files" Margin="0,10,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
                    <Button Name="btnProcessFiles"
                            Content="Start Processing"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            IsEnabled="{Binding IsProcessingEnabled}"
                            Command="{Binding ProcessFilesCommand}"/>

                    <Button Name="btnPauseProcessing"
                            Content="{Binding ProcessingPauseButtonText}"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            Margin="10,0,0,0"
                            IsEnabled="{Binding IsProcessing}"
                            Command="{Binding PauseProcessingCommand}"/>

                    <Button Name="btnCancelProcessing"
                            Content="Cancel Processing"
                            Width="150"
                            Height="35"
                            FontSize="14"
                            Margin="10,0,0,0"
                            IsEnabled="{Binding IsProcessing}"
                            Command="{Binding CancelProcessingCommand}"/>

                    <TextBlock Text="Status:"
                               VerticalAlignment="Center"
                               Margin="20,0,5,0"/>
                    <TextBlock Text="{Binding ProcessingStatus}"
                               VerticalAlignment="Center"
                               FontWeight="Bold"/>
                </StackPanel>

                <ProgressBar Grid.Row="1"
                            Height="25"
                            Value="{Binding ProcessingProgress}"
                            Maximum="100"
                            Margin="0,0,0,10"/>

                <TextBlock Grid.Row="2"
                          Text="{Binding CurrentProcessingFile}"
                          Margin="0,0,0,5"/>
            </Grid>
        </GroupBox>

        <!-- Processing Log -->
        <GroupBox Grid.Row="3" Header="Processing Log" Margin="0,0,0,10">
            <ScrollViewer Name="scrollProcessingLog" VerticalScrollBarVisibility="Auto">
                <TextBox Name="txtProcessingLog"
                        Text="{Binding ProcessingLog}"
                        IsReadOnly="True"
                        TextWrapping="Wrap"
                        FontFamily="Consolas"
                        Background="#F5F5F5"
                        TextChanged="txtProcessingLog_TextChanged"/>
            </ScrollViewer>
        </GroupBox>

        <!-- Status Bar -->
        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="{Binding LastUpdateTime, StringFormat='Last Updated: {0:HH:mm:ss}'}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>